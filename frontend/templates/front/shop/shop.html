{% extends "front/base.html" %}
{% load static %}

{% block custom_css %}
<link rel="stylesheet" type="text/css" href="{% static 'front/assets/css/style.min.css' %}">


{% endblock custom_css %}

{% block content %}
            <!-- Start of Breadcrumb -->
            <nav class="breadcrumb-nav">
                <div class="container">
                    <ul class="breadcrumb bb-no">
                        <li><a href="{% url 'home' %}">Home</a></li>
                        <li>Shop</li>
                    </ul>
                </div>
            </nav>
            <!-- End of Breadcrumb -->

            <!-- Start of Page Content -->
            <div class="page-content">
                <div class="container">
                    <!-- Start of Shop Banner -->
                    <div class="shop-default-banner banner d-flex align-items-center mb-5 br-xs"
                    style="background-image: url({{ banner_url }}); background-color: #FFC74E; width: 1244px; height: 257px;">
               </div>
                    <!-- End of Shop Banner -->

                    <!-- Start of Shop Category -->
                    {% comment %} <div class="shop-default-category category-ellipse-section mb-6">
                        <div class="swiper-container swiper-theme shadow-swiper"
                            data-swiper-options="{
                            'spaceBetween': 20,
                            'slidesPerView': 2,
                            'breakpoints': {
                                '480': {
                                    'slidesPerView': 3
                                },
                                '576': {
                                    'slidesPerView': 4
                                },
                                '768': {
                                    'slidesPerView': 6
                                },
                                '992': {
                                    'slidesPerView': 7
                                },
                                '1200': {
                                    'slidesPerView': 8,
                                    'spaceBetween': 30
                                }
                            }
                        }">
                            <div class="swiper-wrapper row gutter-lg cols-xl-8 cols-lg-7 cols-md-6 cols-sm-4 cols-xs-3 cols-2">
                                <div class="swiper-slide category-wrap">
                                    <div class="category category-ellipse">
                                        <figure class="category-media">
                                            <a href="shop-banner-sidebar.html">
                                                <img src="{% static 'front/assets/images/categories/category-4.jpg'%}" alt="Categroy"
                                                    width="190" height="190" style="background-color: #5C92C0;" />
                                            </a>
                                        </figure>
                                        <div class="category-content">
                                            <h4 class="category-name">
                                                <a href="shop-banner-sidebar.html">Sports</a>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide category-wrap">
                                    <div class="category category-ellipse">
                                        <figure class="category-media">
                                            <a href="shop-banner-sidebar.html">
                                                <img src="{% static 'front/assets/images/categories/category-5.jpg'%}" alt="Categroy"
                                                    width="190" height="190" style="background-color: #B8BDC1;" />
                                            </a>
                                        </figure>
                                        <div class="category-content">
                                            <h4 class="category-name">
                                                <a href="shop-banner-sidebar.html">Babies</a>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide category-wrap">
                                    <div class="category category-ellipse">
                                        <figure class="category-media">
                                            <a href="shop-banner-sidebar.html">
                                                <img src="{% static 'front/assets/images/categories/category-6.jpg'%}" alt="Categroy"
                                                    width="190" height="190" style="background-color: #99C4CA;" />
                                            </a>
                                        </figure>
                                        <div class="category-content">
                                            <h4 class="category-name">
                                                <a href="shop-banner-sidebar.html">Sneakers</a>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide category-wrap">
                                    <div class="category category-ellipse">
                                        <figure class="category-media">
                                            <a href="shop-banner-sidebar.html">
                                                <img src="{% static 'front/assets/images/categories/category-7.jpg'%}" alt="Categroy"
                                                    width="190" height="190" style="background-color: #4E5B63;" />
                                            </a>
                                        </figure>
                                        <div class="category-content">
                                            <h4 class="category-name">
                                                <a href="shop-banner-sidebar.html">Cameras</a>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide category-wrap">
                                    <div class="category category-ellipse">
                                        <figure class="category-media">
                                            <a href="shop-banner-sidebar.html">
                                                <img src="{% static 'front/assets/images/categories/category-8.jpg'%}" alt="Categroy"
                                                    width="190" height="190" style="background-color: #D3E5EF;" />
                                            </a>
                                        </figure>
                                        <div class="category-content">
                                            <h4 class="category-name">
                                                <a href="shop-banner-sidebar.html">Games</a>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide category-wrap">
                                    <div class="category category-ellipse">
                                        <figure class="category-media">
                                            <a href="shop-banner-sidebar.html">
                                                <img src="{% static 'front/assets/images/categories/category-9.jpg'%}" alt="Categroy"
                                                    width="190" height="190" style="background-color: #65737C;" />
                                            </a>
                                        </figure>
                                        <div class="category-content">
                                            <h4 class="category-name">
                                                <a href="shop-banner-sidebar.html">Kitchen</a>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide category-wrap">
                                    <div class="category category-ellipse">
                                        <figure class="category-media">
                                            <a href="shop-banner-sidebar.html">
                                                <img src="{% static 'front/assets/images/categories/category-20.jpg'%}" alt="Categroy"
                                                    width="190" height="190" style="background-color: #E4E4E4;" />
                                            </a>
                                        </figure>
                                        <div class="category-content">
                                            <h4 class="category-name">
                                                <a href="shop-banner-sidebar.html">Watches</a>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="swiper-slide category-wrap">
                                    <div class="category category-ellipse">
                                        <figure class="category-media">
                                            <a href="shop-banner-sidebar.html">
                                                <img src="{% static 'front/assets/images/categories/category-21.jpg'%}" alt="Categroy"
                                                    width="190" height="190" style="background-color: #D3D8DE;" />
                                            </a>
                                        </figure>
                                        <div class="category-content">
                                            <h4 class="category-name">
                                                <a href="shop-banner-sidebar.html">Clothes</a>
                                            </h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="swiper-pagination"></div>
                        </div>
                    </div> {% endcomment %}
                    <!-- End of Shop Category -->

                    <!-- Start of Shop Content -->
                    <div class="shop-content row gutter-lg mb-10">
                        <!-- Start of Sidebar, Shop Sidebar -->
                        <aside class="sidebar shop-sidebar sticky-sidebar-wrapper sidebar-fixed">
                            <!-- Start of Sidebar Overlay -->
                            <div class="sidebar-overlay"></div>
                            <a class="sidebar-close" href="#"><i class="close-icon"></i></a>

                            <!-- Start of Sidebar Content -->
                            <div class="sidebar-content scrollable">
                                <!-- Start of Sticky Sidebar -->
                                <div class="sticky-sidebar">
                                    <div class="filter-actions">
                                        <label>Filter :</label>
                                        <a href="#" class="btn btn-dark btn-link filter-clean">Clean All</a>
                                    </div>
                                    <!-- Start of Collapsible widget -->
                                    <ul class="widget-body filter-items search-ul">
                                        {% for category in categories %}
                                            {% if category.has_children %}
                                                {# Show subcategories instead of parent #}
                                                {% for child in category.subcategories.all %}
                                                    <li>
                                                        <a href="{% url 'shop_by_category' child.slug %}">
                                                            {{ child.name }}
                                                        </a>
                                                    </li>
                                                {% endfor %}
                                            {% else %}
                                                {# Show parent itself if no children #}
                                                <li>
                                                    <a href="{% url 'shop_by_category' category.slug %}">
                                                        {{ category.name }}
                                                    </a>
                                                </li>
                                            {% endif %}
                                        {% empty %}
                                            <li>No categories available</li>
                                        {% endfor %}
                                    </ul>
                                    
                                    
                                    
                                    <!-- End of Collapsible Widget -->

                                    <!-- Start of Collapsible Widget -->
                                    <div class="widget widget-collapsible">
                                        <h3 class="widget-title"><span>Price(৳)</span></h3>
                                        <div class="widget-body">
                                            <ul class="filter-items search-ul">
                                                <li><a href="?min_price=0&max_price=100">0.00 - 100.00</a></li>
                                                <li><a href="?min_price=100&max_price=200">100.00 - 200.00</a></li>
                                                <li><a href="?min_price=200&max_price=300">200.00 - 300.00</a></li>
                                                <li><a href="?min_price=300&max_price=500">300.00 - 500.00</a></li>
                                                <li><a href="?min_price=500">500.00+</a></li>
                                            </ul>
                                    
                                            <form method="get" class="price-range">
                                                <input type="number" name="min_price" class="min_price text-center"
                                                    placeholder="৳{{ price_range.min_price|default:0 }}"
                                                    value="{{ request.GET.min_price }}">
                                                <span class="delimiter">-</span>
                                                <input type="number" name="max_price" class="max_price text-center"
                                                    placeholder="৳{{ price_range.max_price|default:0 }}"
                                                    value="{{ request.GET.max_price }}">
                                                <button type="submit" class="btn btn-primary btn-rounded">Go</button>
                                            </form>
                                        </div>
                                    </div>
                                    
                                    <!-- End of Collapsible Widget -->

                                    <!-- Start of Collapsible Widget -->
                                    {% comment %} <div class="widget widget-collapsible">
                                        <h3 class="widget-title"><span>Size</span></h3>
                                        <ul class="widget-body filter-items item-check mt-1">
                                            <li><a href="#">Extra Large</a></li>
                                            <li><a href="#">Large</a></li>
                                            <li><a href="#">Medium</a></li>
                                            <li><a href="#">Small</a></li>
                                        </ul>
                                    </div>
                                    <!-- End of Collapsible Widget -->

                                    <!-- Start of Collapsible Widget -->
                                    <div class="widget widget-collapsible">
                                        <h3 class="widget-title"><span>Brand</span></h3>
                                        <ul class="widget-body filter-items item-check mt-1">
                                            <li><a href="#">Elegant Auto Group</a></li>
                                            <li><a href="#">Green Grass</a></li>
                                            <li><a href="#">Node Js</a></li>
                                            <li><a href="#">NS8</a></li>
                                            <li><a href="#">Red</a></li>
                                            <li><a href="#">Skysuite Tech</a></li>
                                            <li><a href="#">Sterling</a></li>
                                        </ul>
                                    </div>
                                    <!-- End of Collapsible Widget -->

                                    <!-- Start of Collapsible Widget -->
                                    <div class="widget widget-collapsible">
                                        <h3 class="widget-title"><span>Color</span></h3>
                                        <ul class="widget-body filter-items item-check mt-1">
                                            <li><a href="#">Black</a></li>
                                            <li><a href="#">Blue</a></li>
                                            <li><a href="#">Brown</a></li>
                                            <li><a href="#">Green</a></li>
                                            <li><a href="#">Grey</a></li>
                                            <li><a href="#">Orange</a></li>
                                            <li><a href="#">Yellow</a></li>
                                        </ul>
                                    </div> {% endcomment %}
                                    <!-- End of Collapsible Widget -->
                                </div>
                                <!-- End of Sidebar Content -->
                            </div>
                            <!-- End of Sidebar Content -->
                        </aside>
                        <!-- End of Shop Sidebar -->

                        <!-- Start of Shop Main Content -->
                        <div class="main-content">
                            <nav class="toolbox sticky-toolbox sticky-content fix-top">
                                <div class="toolbox-left">
                                    <a href="#" class="btn btn-primary btn-outline btn-rounded left-sidebar-toggle 
                                        btn-icon-left d-block d-lg-none">
                                        <i class="w-icon-category"></i><span>Filters</span>
                                    </a>
                            
                                    <!-- Sort Dropdown -->
                                    <div class="toolbox-item toolbox-sort select-box text-dark">
                                        <form method="get" id="sortForm">
                                            <!-- Keep other query params (price filters, count, etc.) -->
                                            {% for key, value in request.GET.items %}
                                                {% if key != "orderby" %}
                                                    <input type="hidden" name="{{ key }}" value="{{ value }}">
                                                {% endif %}
                                            {% endfor %}
                            
                                            <label>Sort By :</label>
                                            <select name="orderby" class="form-control" onchange="this.form.submit()">
                                                <option value="default" {% if orderby == "default" %}selected{% endif %}>Default sorting</option>
                                                <option value="popularity" {% if orderby == "popularity" %}selected{% endif %}>Sort by popularity</option>
                                                <option value="rating" {% if orderby == "rating" %}selected{% endif %}>Sort by average rating</option>
                                                <option value="date" {% if orderby == "date" %}selected{% endif %}>Sort by latest</option>
                                                <option value="price-low" {% if orderby == "price-low" %}selected{% endif %}>Sort by price: low to high</option>
                                                <option value="price-high" {% if orderby == "price-high" %}selected{% endif %}>Sort by price: high to low</option>
                                            </select>
                                        </form>
                                    </div>
                                </div>
                            
                                <div class="toolbox-right">
                                    <!-- Show Count Dropdown -->
                                    <div class="toolbox-item toolbox-show select-box">
                                        <form method="get" id="countForm">
                                            {% for key, value in request.GET.items %}
                                                {% if key != "count" %}
                                                    <input type="hidden" name="{{ key }}" value="{{ value }}">
                                                {% endif %}
                                            {% endfor %}
                            
                                            <select name="count" class="form-control" onchange="this.form.submit()">
                                                <option value="9" {% if count == 9 %}selected{% endif %}>Show 9</option>
                                                <option value="12" {% if count == 12 %}selected{% endif %}>Show 12</option>
                                                <option value="24" {% if count == 24 %}selected{% endif %}>Show 24</option>
                                                <option value="36" {% if count == 36 %}selected{% endif %}>Show 36</option>
                                            </select>
                                        </form>
                                    </div>
                                </div>
                            </nav>
                            
                            <div class="product-wrapper row cols-lg-4 cols-md-3 cols-sm-2 cols-2">
                                {% for product in products %}
                                <div class="product-wrap">
                                    <div class="product text-center">
                                        <figure class="product-media">
                                            <a href="{% url 'product_details' product.slug %}">
                                                {% if product.thumbnail_small %}
                                                    <img src="{{ product.thumbnail_small.url }}" alt="{{ product.title }}" width="300" height="338" />
                                                {% else %}
                                                    <img src="{{ product.thumbnail_image.url }}" alt="{{ product.title }}" width="300" height="338" />
                                                {% endif %}
                                            </a>
                                            <div class="product-action-horizontal">
                                                <a href="#" class="btn-product-icon btn-cart w-icon-cart" data-product-id="{{ product.id }}"
                                                   title="Add to cart"></a>
                                                {% comment %} <a href="#" class="btn-product-icon btn-wishlist w-icon-heart"
                                                   title="Wishlist"></a>
                                                <a href="#" class="btn-product-icon btn-compare w-icon-compare"
                                                   title="Compare"></a> {% endcomment %}
                                                <a href="#" class="btn-product-icon btn-quickview w-icon-search"
                                                   title="Quick View"></a>
                                            </div>
                                        </figure>
                                        <div class="product-details">
                                            <div class="product-cat">
                                                <a href="#">{{ product.category.name }}</a>
                                            </div>
                                            <h3 class="product-name">
                                                <a href="{% url 'product_details' product.slug %}">{{ product.title }}</a>
                                            </h3>
                                            <div class="ratings-container">
                                                <div class="ratings-full">
                                                    <span class="ratings" style="width: 100%;"></span>
                                                    <span class="tooltiptext tooltip-top"></span>
                                                </div>
                                                <a href="{% url 'product_details' product.slug %}" class="rating-reviews">(0 reviews)</a>
                                            </div>
                                            <div class="product-pa-wrapper">
                                                <div class="product-price">
                                                    ৳{{ product.get_discounted_price }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% empty %}
                                <p>No products available.</p>
                                {% endfor %}
                            </div>
                            

                            <div class="toolbox toolbox-pagination justify-content-between">
                                <p class="showing-info mb-2 mb-sm-0">
                                    Showing 
                                    <span>
                                        {{ products.start_index }}-{{ products.end_index }} of {{ products.paginator.count }}
                                    </span> 
                                    Products
                                </p>
                            
                                <ul class="pagination">
                                    {# Previous button #}
                                    {% if products.has_previous %}
                                        <li class="prev">
                                            <a href="?page={{ products.previous_page_number }}&{{ request.GET.urlencode }}" aria-label="Previous">
                                                <i class="w-icon-long-arrow-left"></i>Prev
                                            </a>
                                        </li>
                                    {% else %}
                                        <li class="prev disabled">
                                            <a href="#" aria-label="Previous" tabindex="-1" aria-disabled="true">
                                                <i class="w-icon-long-arrow-left"></i>Prev
                                            </a>
                                        </li>
                                    {% endif %}
                            
                                    {# Page numbers #}
                                    {% for page_num in products.paginator.page_range %}
                                        {% if products.number == page_num %}
                                            <li class="page-item active">
                                                <a class="page-link" href="#">{{ page_num }}</a>
                                            </li>
                                        {% else %}
                                            <li class="page-item">
                                                <a class="page-link" href="?page={{ page_num }}&{{ request.GET.urlencode }}">{{ page_num }}</a>
                                            </li>
                                        {% endif %}
                                    {% endfor %}
                            
                                    {# Next button #}
                                    {% if products.has_next %}
                                        <li class="next">
                                            <a href="?page={{ products.next_page_number }}&{{ request.GET.urlencode }}" aria-label="Next">
                                                Next<i class="w-icon-long-arrow-right"></i>
                                            </a>
                                        </li>
                                    {% else %}
                                        <li class="next disabled">
                                            <a href="#" aria-label="Next" tabindex="-1" aria-disabled="true">
                                                Next<i class="w-icon-long-arrow-right"></i>
                                            </a>
                                        </li>
                                    {% endif %}
                                </ul>
                            </div>
                            
                        </div>
                        <!-- End of Shop Main Content -->
                    </div>
                    <!-- End of Shop Content -->
                </div>
            </div>
            <!-- End of Page Content -->
            {% endblock content %}

            {% block custom_js %}
            
            {% endblock custom_js %}